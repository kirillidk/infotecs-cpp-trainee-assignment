# Cpp Logging Library

Многопоточная библиотека для записи сообщений в журнал с различными уровнями важности и приложения для демонстрации её работы.

## Содержание

1. [Описание проекта](#описание-проекта)
2. [Архитектура](#архитектура)
3. [Сборка проекта](#сборка-проекта)
4. [Компоненты системы](#компоненты-системы)
5. [Использование](#использование)
6. [Примеры запуска](#примеры-запуска)
7. [Структура проекта](#структура-проекта)

## Описание проекта

Проект состоит из трех основных частей:

1. **Библиотека логирования** - основная библиотека для записи сообщений
2. **Тестовое приложение** - консольное многопоточное приложение для демонстрации работы библиотеки
3. **Приложение метрик** - программа для сбора статистики по данным из сокета

## Архитектура

### Библиотека логирования (`logger`)

Библиотека поддерживает два типа вывода:
- **FileSink** - запись в текстовый файл
- **SocketSink** - отправка через TCP сокет

Основные компоненты:
- `Logger` - основной класс для логирования
- `ILogSink` - интерфейс для различных способов вывода
- `LogLevel` - перечисление уровней важности (DEBUG, INFO, WARNING, ERROR, FATAL)
- `utility` - вспомогательные функции форматирования

### Тестовое приложение (`test_application`)

Консольное приложение с следующими возможностями:
- Интерактивный ввод сообщений от пользователя
- Потокобезопасная передача данных в отдельный поток для записи
- Поддержка различных уровней важности сообщений
- Возможность работы с файлом или сокетом

### Приложение метрик (`metrics_application`)

Серверное приложение для сбора статистики:
- Прием данных из TCP сокета от библиотеки логирования
- Подсчет статистик количества и длины сообщений
- Периодический вывод статистики в консоль

## Сборка проекта

### Требования

- Компилятор: GCC 13+ или Clang 15+ с поддержкой C++17
- Система сборки: CMake 3.17+
  
### Команды сборки

```bash
git clone https://github.com/kirillidk/infotecs-cpp-trainee-assignment
cd infotecs-cpp-trainee-assignment

cmake -S . -B build -DBUILD_SHARED=ON
cmake --build build
```

### Тестирование

```bash
cmake --build build --target test
```

### Результат сборки

Исполняемые файлы в build/bin

## Компоненты системы

### 1. Библиотека логирования

#### Основные функции:
- Запись сообщений с временными метками
- Фильтрация по уровню важности
- Потокобезопасная работа
- Поддержка файлового и сетевого вывода

#### Уровни важности:
- `DEBUG` (0) - отладочная информация
- `INFO` (1) - информационные сообщения
- `WARNING` (2) - предупреждения
- `ERROR` (3) - ошибки
- `FATAL` (4) - критические ошибки

### 2. Тестовое приложение

#### Команды:
- `<сообщение>` - запись сообщения с уровнем по умолчанию
- `<сообщение> <уровень>` - запись сообщения с указанным уровнем
- `help` - показать справку
- `exit` или `quit` - выход из приложения

### 3. Приложение метрик

#### Собираемые статистики:
**Количество сообщений:**
- Общее количество сообщений
- Количество по уровням важности
- Количество за последний час

**Статистики длины сообщений:**
- Минимальная длина
- Максимальная длина
- Средняя длина

#### Условия вывода статистики:
- После получения N-го сообщения
- После таймаута T секунд (при изменении статистики)

## Использование

### Тестовое приложение

#### Режим записи в файл:
```bash
./test_application --file <имя_файла> [--level <уровень>]
```

#### Режим записи в сокет:
```bash
./test_application --socket <хост> <порт> [--level <уровень>]
```

### Приложение метрик

```bash
./metrics_application <хост> <порт> <N> <T>
```

Где:
- `хост` - адрес для прослушивания
- `порт` - порт для прослушивания
- `N` - интервал сообщений для вывода статистики
- `T` - таймаут в секундах для вывода статистики

## Примеры запуска

### Запуск с файловым выводом:
```bash
# Тестовое приложение записывает в файл app.log
./test_application --file app.log --level debug
```

### Запуск с сокетом:
```bash
# Терминал 1: запуск приложения метрик
./metrics_application 127.0.0.1 9000 5 10

# Терминал 2: запуск тестового приложения
./test_application --socket 127.0.0.1 9000 --level info
```

## Структура проекта

```
├── src/
│   ├── logger/                 
│   │   ├── logger.hpp/cpp      
│   │   ├── file_sink.hpp/cpp   
│   │   ├── socket_sink.hpp/cpp 
│   │   ├── sink.hpp            
│   │   ├── log_level.hpp       
│   │   └── utility.hpp/cpp     
│   │
│   ├── test_application/       
│   │   ├── main.cpp           
│   │   ├── test_application.hpp/cpp
│   │   ├── argument_parser.hpp/cpp
│   │   ├── command_parser.hpp/cpp
│   │   ├── thread_safe_queue.hpp
│   │   └── utility.hpp/cpp
│   │
│   └── metrics_application/    
│       ├── main.cpp           
│       ├── metrics_application.hpp/cpp
│       ├── socket_server.hpp/cpp
│       ├── message_processor.hpp/cpp
│       ├── metrics_collector.hpp/cpp
│       └── utility.hpp/cpp
│
├── CMakeLists.txt             
└── README.md                  
```
